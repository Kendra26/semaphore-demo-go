version: v1.0

name: Download Torrent and Upload to PixelDrain

agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu2004

blocks:
  - name: Download & Upload
    task:
      env_vars:
        - name: PIXELDRAIN_API_KEY
          value: 5f45f184-64bb-4eaa-be19-4a5f0459db49   # üîê Replace with your actual key
        - name: TORRENT_MAGNET
          value: "magnet:?xt=urn:btih:..."              # üîó Replace with your magnet link
      jobs:
        - name: Download and Upload Files
          commands:
            - checkout
            - echo "üì¶ Installing webtorrent-cli..."
            - sudo apt update
            - sudo apt install -y nodejs npm
            - npm install webtorrent-cli

            - echo "üì• Downloading torrent..."
            - mkdir downloads
            - npx webtorrent "magnet:?xt=urn:btih:6e40b85d91e5852bc0c07510eed081e9446e617d&dn=Big%20City%20Greens%20S04E46%20Remy%20Dillemy%20720p%20HULU%20WEB-DL%20DDP5%201%20H%20264-NTb%5BEZTVx.to%5D.mkv%5Beztv%5D&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337%2Fannounce&tr=udp%3A%2F%2Fp4p.arenabg.com%3A1337%2Fannounce&tr=udp%3A%2F%2Ftracker.torrent.eu.org%3A451%2Fannounce&tr=udp%3A%2F%2Fopen.stealth.si%3A80%2Fannounce" "magnet:?xt=urn:btih:22b89a678fd5e5b90d2b7d2f8aa29be9db02a3d8&dn=Big%20City%20Greens%20S04E45%20Saxon%20Saxability%20720p%20HULU%20WEB-DL%20DDP5%201%20H%20264-NTb%5BEZTVx.to%5D.mkv%5Beztv%5D&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337%2Fannounce&tr=udp%3A%2F%2Fp4p.arenabg.com%3A1337%2Fannounce&tr=udp%3A%2F%2Ftracker.torrent.eu.org%3A451%2Fannounce&tr=udp%3A%2F%2Fopen.stealth.si%3A80%2Fannounce" "magnet:?xt=urn:btih:b9bc4983c4e0953d1a1f84cc21bb65435231c567&dn=Hell%20Motel%20S01E04%20Devil%20in%20the%20Details%20720p%20AMZN%20WEB-DL%20DDP5%201%20H%20264-RAWR%5BEZTVx.to%5D.mkv%5Beztv%5D&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337%2Fannounce&tr=udp%3A%2F%2Fp4p.arenabg.com%3A1337%2Fannounce&tr=udp%3A%2F%2Ftracker.torrent.eu.org%3A451%2Fannounce&tr=udp%3A%2F%2Fopen.stealth.si%3A80%2Fannounce" "magnet:?xt=urn:btih:403a4bbf634b665ffba0c270d81288e71a94e39f&dn=Kiff%20S02E27%20Kiff%20and%20Barry%20Save%20Halfway%20There%20Day%20720p%20HULU%20WEB-DL%20DDP5%201%20H%20264-NTb%5BEZTVx.to%5D.mkv%5Beztv%5D&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337%2Fannounce&tr=udp%3A%2F%2Fp4p.arenabg.com%3A1337%2Fannounce&tr=udp%3A%2F%2Ftracker.torrent.eu.org%3A451%2Fannounce&tr=udp%3A%2F%2Fopen.stealth.si%3A80%2Fannounce" "magnet:?xt=urn:btih:b6340787c029eec4bab3e2f9650d8b747659ecf9&dn=Wylde%20Pak%20S01E09%20Left%20Holding%20the%20Bag%20720p%20AMZN%20WEB-DL%20DDP2%200%20H%20264-NTb%5BEZTVx.to%5D.mkv%5Beztv%5D&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337%2Fannounce&tr=udp%3A%2F%2Fp4p.arenabg.com%3A1337%2Fannounce&tr=udp%3A%2F%2Ftracker.torrent.eu.org%3A451%2Fannounce&tr=udp%3A%2F%2Fopen.stealth.si%3A80%2Fannounce" "magnet:?xt=urn:btih:256a90741e9d23ef66d7888aa1de297273bddc56&dn=Wylde%20Pak%20S01E08%20The%20Three%20Ravens%20720p%20AMZN%20WEB-DL%20DDP2%200%20H%20264-NTb%5BEZTVx.to%5D.mkv%5Beztv%5D&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337%2Fannounce&tr=udp%3A%2F%2Fp4p.arenabg.com%3A1337%2Fannounce&tr=udp%3A%2F%2Ftracker.torrent.eu.org%3A451%2Fannounce&tr=udp%3A%2F%2Fopen.stealth.si%3A80%2Fannounce" --out downloads

            - echo "üì§ Uploading files to PixelDrain..."
            - |
              find downloads -type f | while read file; do
                echo "Uploading $file..."
                response=$(curl -s -T "$file" -u :8ec6f000-e8d1-403d-820b-4324a6a68869 https://pixeldrain.com/api/file/)
                id=$(echo "$response" | grep -o '"id":"[^"]*"' | cut -d':' -f2 | tr -d '"')
                echo "‚úÖ $file uploaded: https://pixeldrain.com/u/$id"
              done

