version: v1.0

name: Download Torrent and Upload to PixelDrain

agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu2004

blocks:
  - name: Download & Upload
    task:
      jobs:
        - name: Download and Upload Files
          commands:
            - checkout
            - echo "ðŸ“¦ Installing webtorrent-cli..."
            - sudo apt update
            - sudo apt install -y aria2
            - echo "ðŸ“¥ Downloading torrent..."
            - mkdir -p downloads
            - wget --content-disposition "http://itorrents.org/torrent/330EC13E67640F4187FDDB1C84AF1518759CD3D0.torrent"
            - aria2c --seed-time=0 --dir=downloads --select-file=77-103 *.torrent
            
            - echo "ðŸ“¤ Uploading files to PixelDrain..."
            - |
               find downloads -type f -print0 | while IFS= read -r -d '' file; do
                curl -g -X POST "https://upload.gofile.io/uploadfile" \
                     -H "Authorization: Bearer D6TLIacgqNHu93hAjSOBgyZxOWEUOmzO" \
                     -F "file=@\"$file\"" \
                     -F "folderId=687ab9bc-238b-407a-8f95-a50c6b4b717e"
                done
