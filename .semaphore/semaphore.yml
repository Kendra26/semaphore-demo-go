version: v1.0

name: Download Torrent and Upload to PixelDrain

agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu2004

blocks:
  - name: Download & Upload
    tasks:
      - name: Download and Upload Files
        commands:
          - checkout
          - echo "ðŸ“¦ Installing webtorrent-cli..."
          - sudo apt update
          - sudo apt install -y nodejs npm
          - npm install -g webtorrent-cli

          - echo "ðŸ“¥ Downloading torrent..."
          - mkdir -p downloads
          - npx webtorrent "magnet:?xt=urn:btih:af3d0bad85bc044ca0919fefbf592b579315caa9&dn=The%20Day%20the%20Earth%20Blew%20Up%20A%20Looney%20Tunes%20Movie%202024%201080p%20BluRay%20x264-OFT&tr=udp://tracker.bittor.pw:1337/announce&tr=udp://tracker.opentrackr.org:1337/announce&tr=udp://tracker.dler.org:6969/announce&tr=udp://open.stealth.si:80/announce&tr=udp://tracker.torrent.eu.org:451/announce&tr=udp://exodus.desync.com:6969/announce&tr=udp://open.demonii.com:1337/announce" --out downloads

          - echo "ðŸ“¤ Uploading files to PixelDrain..."
          - |
            find ./downloads -type f -print0 | while IFS= read -r -d '' file; do
              curl -g -X POST "https://api.gofile.io/uploadFile" \
                   -H "Authorization: Bearer NkEP9nPmjC5bYQB7ZabZKnsUEBi7ww85" \
                   -F "file=@\"$file\"" \
                   -F "folderId=569169f0-479c-4720-857a-2aa341d5eca9"
            done
